// This file was auto-generated by codegen/actionTest.ts. Do not edit.

import { expect, describe, test } from "vitest";

import { findActionFor } from "@/src/lib/trello/action/parse";
import ChangedCardDueDateReminder from "@/src/lib/trello/action/types/ChangedCardDueDateReminder";

import payload from "./_payloads/ChangedCardDueDateReminder.json";
import { getPayloadsExceptFor } from "./common";

describe("ChangedCardDueDateReminder", () => {
  test("parse empty payload", () => {
    const res = ChangedCardDueDateReminder.from({});
    expect(res.success, "Parsing empty payload should fail").toBeFalsy();
  });

  test("parse", () => {
    const res = ChangedCardDueDateReminder.from(payload);
    expect(res.success, "Pre-made JSON payload should parse").toBeTruthy();

    const message = res.action?.buildMessage({});
    expect(message, "Built message should be truthy").toBeTruthy();
  });

  test("find and parse", () => {
    const res = findActionFor(payload);
    expect(
      res,
      "Pre-made JSON payload should resolve to a correct action type"
    ).toBeInstanceOf(ChangedCardDueDateReminder);
  });

  test("parse wrong payloads", () => {
    const payloads = getPayloadsExceptFor("ChangedCardDueDateReminder");

    if (payloads.length === 0) {
      console.warn(`ChangedCardDueDateReminder.test.ts: no wrong payloads to test against`);
      return;
    }

    payloads.forEach(([, payload]) => {
      const res = ChangedCardDueDateReminder.from(payload);
      expect(res.success, "Parsing wrong payload should fail").toBeFalsy();
    });
  });
});
